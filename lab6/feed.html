<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Minecraft, Майнкрафт">
    <meta name="description" content="Сообщество по майнкрафту">

    <title>CraftersHub</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

<header class="header">
    <h1 class="header__title">Лента
        <img src="Cartography_Table.webp" alt="Header Image">
    </h1>
    <div class="header__buttons">
        <button class="fake-button">Sign Up</button>
        <button class="fake-button">Login</button>
        <button class="fake-button">My Profile</button>
    </div>
</header>

<main class="main">
    <div id="nav-container"></div>
    <script src="loadNav.js"></script>

    <div class="table-container">
        <h2 class="table-container__title">Posts</h2>
        <div class="table-header">
            <div class="table-cell">userId</div>
            <div class="table-cell">id</div>
            <div class="table-cell">title</div>
            <div class="table-cell">body</div>
        </div>
        <div class="table-row">
            <div class="table-cell">user</div>
            <div class="table-cell">1.19.4 Vanilla</div>
            <div class="table-cell">мой папа</div>
            <div class="table-cell">128.8kk</div>
        </div>
    </div>
</main>

<footer class="footer">
    <p class="footer__text">&copy; 2023 Crafters Hub. Все права не защищены.</p>
</footer>
<script src="activeNav.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Показываем индикатор загрузки
        document.querySelector('.table-container').innerHTML = '<img src="sheep_loading.gif" alt="Loading...">';

        setTimeout(function () {
            fetch('https://jsonplaceholder.typicode.com/posts')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    updateTable(data);
                })
                .catch(error => {
                    console.error('Error fetching data:', error)
                    showError();
                });
        }, 3000);
    });

    function updateTable(data) {
        const randomFail = Math.random() < 0.5;
        if (randomFail) {
            showError();
            return;
        }

        const filtered = data.filter(post => post.userId % 2 == 0 && post.id % 2 == 0)

        let tableHTML = `
        <h2 class="table-container__title">Posts</h2>
        <div class="table-header">
            <div class="table-cell">userId</div>
            <div class="table-cell">id</div>
            <div class="table-cell">title</div>
            <div class="table-cell">body</div>
        </div>
    `;

        filtered.forEach(post => {
            tableHTML += `
            <div class="table-row">
                <div class="table-cell">${post.userId}</div>
                <div class="table-cell">${post.id}</div>
                <div class="table-cell">${post.title}</div>
                <div class="table-cell">${post.body}</div>
            </div>
        `;
        });

        document.querySelector('.table-container').innerHTML = tableHTML;
    }

    function showError() {
        document.querySelector('.table-container').innerHTML = `
        <img src="sheep_failed.png" alt="Failed to load">
        <p>Ой, что-то пошло не так.</p>
    `;
    }
</script>

</body>

</html>
